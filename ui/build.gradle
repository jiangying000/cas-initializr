plugins {
    id 'base'
    id 'com.github.node-gradle.node' version "${gradleNodePluginVersion}"
}

node {
    version = "${gradleNodeVersion}"
    npmVersion = "${gradleNpmVersion}"
    download = true
}

npmInstall.setNpmCommand('ci')

task appNpmInstall(type: NpmTask) {
    description = "Installs all dependencies from package.json"
    args = ["install"]
}

task appNpmBuild(type: NpmTask, dependsOn: "build") {
    description = "Builds production version of the webapp"
    args = ["run", "build"]
}

appNpmBuild.dependsOn appNpmInstall

clean.doFirst {
    file('node_modules').deleteDir()
    file('build').deleteDir()
}
